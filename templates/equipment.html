<!DOCTYPE html>
<html lang="ru">
{{define "content"}}

<body>
    <div class="form-container">
        <h2>Редактирование оборудования</h2>

        <form method="POST" action="/equipment/{{.Equipment.Id}}">
            <div class="form-group">
                <label for="invNum">Инвентарный номер:</label>
                <input type="text" id="invNum" name="invNum"
                       value="{{if .InvNum}}{{.InvNum}}{{else}}{{.Equipment.InvNum}}{{end}}"
                       class="form-input {{if .InvNumError}}input-error{{end}}">
                {{if .InvNumError}}
                    <div class="error-message">{{.InvNumError}}</div>
                {{end}}
            </div>

            {{if not .IsPC}}
            <div class="form-group">
                <label for="purchDate">Дата приобретения:</label>
                <input type="text" id="purchDate" name="purchDate" value="{{.Equipment.PurchDate}}" readonly class="form-input readonly">
            </div>
            {{end}}

            <div class="form-group">
                <label for="regDate">Дата постановки на учет:</label>
                <input type="text" id="regDate" name="regDate" value="{{.Equipment.RegDate}}" readonly class="form-input readonly">
            </div>

            {{if eq .Equipment.StatusId 2}}
            <div class="form-group">
                <label for="decomDate">Дата списания:</label>
                <input type="text" id="decomDate" name="decomDate" value="{{.Equipment.DecomDate}}" readonly class="form-input readonly">
            </div>
            {{end}}

            <div class="form-group">
                <label for="directoryId">Модель оборудования:</label>
                <select id="directoryId" name="directoryId" required class="form-input">
                    {{range .Directories}}
                        <option value="{{.Id}}" {{if eq .Id $.Equipment.DirectoryId}}selected{{end}}>
                            {{.Name}} ({{.ReleaseYear}}, {{.Type}})
                        </option>
                    {{end}}
                </select>
            </div>

            <div class="form-group">
                <label for="departmentId">Подразделение:</label>
                <select id="departmentId" name="departmentId" required class="form-input">
                    {{range .Departments}}
                        <option value="{{.Id}}" {{if eq .Id $.Equipment.DepartmentId}}selected{{end}}>
                            {{.DivisionName}} - {{.Name}}
                        </option>
                    {{end}}
                </select>
            </div>

            <div class="form-group">
                <label for="statusId">Статус:</label>
                <select id="statusId" name="statusId" required class="form-input">
                    {{range .States}}
                        <option value="{{.Id}}" {{if eq .Id $.Equipment.StatusId}}selected{{end}}>{{.Name}}</option>
                    {{end}}
                </select>
            </div>

            {{if .IsPC}}
                <div class="form-group">
                    <label for="cpuId">Процессор:</label>
                    <select id="cpuId" name="cpuId" required class="form-input">
                        {{range .Units.CPUs}}
                            <option value="{{.Id}}" {{if eq .Id $.Equipment.CPU.Id}}selected{{end}}>{{.Name}}</option>
                        {{end}}
                    </select>
                </div>

                <div class="form-group">
                    <label for="gpuId">Видеокарта:</label>
                    <select id="gpuId" name="gpuId" required class="form-input">
                        {{range .Units.GPUs}}
                            <option value="{{.Id}}" {{if eq .Id $.Equipment.GPU.Id}}selected{{end}}>{{.Name}}</option>
                        {{end}}
                    </select>
                </div>

                <div class="form-group">
                    <label for="mbId">Материнская плата:</label>
                    <select id="mbId" name="mbId" required class="form-input">
                        {{range .Units.MBs}}
                            <option value="{{.Id}}" {{if eq .Id $.Equipment.Motherboard.Id}}selected{{end}}>{{.Name}}</option>
                        {{end}}
                    </select>
                </div>

                <div class="form-group">
                    <label for="ram">Объем ОЗУ:</label>
                    <input type="number" id="ram" name="ram" value="{{.Equipment.RAM}}" class="form-input" required min="1">
                </div>

                <div class="form-group">
                    <label for="storage">Объем памяти:</label>
                    <input type="number" id="storage" name="storage" value="{{.Equipment.Storage}}" class="form-input" required min="1">
                </div>
                
            {{end}}

            <div class="form-actions">
                <button type="submit" class="btn btn-primary">Сохранить</button>
                <a href="/equipment" class="btn btn-secondary">Отмена</a>
                <button type="button" class="btn btn-danger"
                        onclick="if(confirm('Удалить это оборудование?')) {
                            document.getElementById('delete-form').submit()
                        }">
                    Удалить
                </button>
            </div>
        </form>

        <form id="delete-form" method="POST" action="/equipment/{{.Equipment.Id}}/delete" style="display: none;"></form>
    </div>
</body>

{{end}}
</html>
